<!-- Used when printing Ctrl+P-->
<div class="visible-print">
    <table class="table table-condensed">
        <tr>
            <th>Navn:</th>
            <td>{{ vm.article.name }}</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <th>Journalister:</th>
            <td>
            <span ng-repeat="journalist in vm.article.journalists">
                {{ journalist.name }}<span ng-if="!$last">,</span>
            </span>
            </td>
            <th>Kommentar:</th>
            <td>{{vm.article.comment}}</td>
        </tr>
        <tr>
            <th>Fotografer:</th>
            <td>
            <span ng-repeat="photographer in vm.article.photographers">
                {{ photographer.name }}<span ng-if="!$last">,</span>
            </span>
            </td>
            <th>Utgave:</th>
            <td>{{vm.article.publication.name }}</td>
        </tr>
    </table>
    <div style="column-count: 2; -moz-column-count:2" ng-bind-html="vm.articleContent | trustHtml"></div>
</div>

<div class="hidden-print">
    <h1>{{vm.article.name}}</h1>

    <div uk-alert class="uk-alert-warning" ng-show="vm.article.archived">
        <p>
            <i class="fas fa-exclamation-circle fa-2"></i>
            <strong> Artikkelen er arkivert.</strong> Den vil ikke vises i søk.
        </p>
    </div>
    
    <!-- Status bar and buttons -->
    <div>
        <div uk-margin>
                <status-widget 
                label="'Seksjon'"
                selected="vm.article.section"
                statuses="vm.sections"
            >
            </status-widget>
            <status-widget 
                label="'Type'"
                selected="vm.article.type"
                statuses="vm.types"
            >
        </div>
        <div uk-margin class="uk-margin-small-top">
            <status-widget 
                label="'Status'"
                selected="vm.article.status"
                statuses="vm.statuses"
                on-change="vm.onStatusChange(status)"
            >
            </status-widget>
            <status-widget 
                label="'Korrektur'"
                selected="vm.article.review"
                statuses="vm.reviews"
                on-change="vm.onReviewStatusChange(status)"
            >
            </status-widget>
            <boolean-widget 
                label="'Sitatsjekk'"
                value="vm.article.quote_check_status"
                on-change="vm.onQuoteCheckStatusChange(value)"
            >
            </boolean-widget>
        </div>
        
        <div uk-margin class="uk-margin-top uk-margin-bottom">
            <a 
                href="https://docs.google.com/document/d/{{vm.article.google_drive_id}}/edit"
                target="_blank"
                class="uk-button uk-button-primary"
            >
                <span class="fas fa-edit"></span>
                Rediger i Google Docs
            </a>
        
            <a ui-sref="articlerevision({id:vm.article.id})" class="uk-button uk-button-primary">
                <i class="fas fa-history"></i>
                Historikk
            </a>
        
            <a href="/api/article/{{vm.article.id}}/indesignfile" class="uk-button uk-button-primary">
                <i class="fas fa-file-alt"></i>
                InDesign-fil
            </a>
        
            <button ng-hide="vm.article.archived" ng-click="vm.archiveArticle()" class="uk-button uk-button-danger">
                <i class="fas fa-trash"></i>
                Arkivér
            </button>
            <button
                ng-show="vm.article.archived" 
                ng-click="vm.restoreArticle()" 
                class="uk-button uk-button-primary" 
                uib-tooltip="Gjenopprett artikkelen så den vil vises i søk"
            >
                <i class="fas fa-plus"></i>
                Gjenopprett
            </button>
        
            <button ng-click="vm.showHelp()" class="uk-button button-new">
                <i class="fas fa-question"></i>
                Hjelp
            </button>
        </div>
    </div>
    
    <div uk-grid class="uk-grid-small">
        <div class="uk-width-3-5@m">
            <panel icon="'fas fa-align-left'" header="'Tekst'" type="'primary'">
                <div class="articleContent" ng-bind-html="vm.articleContent | trustHtml"></div>
                <div class="text-right">
                    <small class="text-muted">
                        Ca. {{vm.article.content_length}} tegn
                    </small>
                </div>
            </panel>
        </div>
    
        <div class="uk-width-2-5@m">
            <panel type="'primary'" no-header class="comment-panel">
                <editable-field
                    type="textarea"
                    label="'Kommentar'"
                    value="vm.article.comment"
                    on-save="vm.onCommentSave(value)">
                </editable-field>
            </panel>
             <panel icon="'fas fa-users'" type="'primary'" header="'Bildetekster'" collapsible class="imagetext-panel">
                <editable-field
                    type="textarea"
                    label="'Bildetekster'"
                    value="vm.article.image_text"
                    on-save="vm.onImageTextSave(value)">
                </editable-field>
            </panel>
            <panel icon="'fas fa-users'" header="'Personer'" type="'edit'">
                <editable-field
                    type="multiselect"
                    label="'Journalister'"
                    value="vm.article.journalists"
                    value-label="name"
                    has-custom-value-markup
                    pool="vm.persons"
                    on-save="vm.onJournalistsSave(value)">
                    <custom-value-markup>
                        <ul class="uk-list list-no-margin">
                            <li ng-repeat="journalist in $parent.vm.value" style="display: flex;">
                                <person-avatar user="journalist" size="30"></person-avatar>
                                <span person-widget="journalist" style="align-self: center; margin-left: 5px;">{{ journalist.name }}</span>
                            </li>
                        </ul>
                    </custom-value-markup>
                </editable-field>

                <editable-field
                    type="text"
                    label="'Eksterne'"
                    value="vm.article.external_author"
                    on-save="vm.onExternalAuthorSave(value)"
                >
                </editable-field>

                <editable-field 
                    type="multiselect"
                    label="vm.article.use_illustration ? 'Illustratører' : 'Fotografer'"
                    value="vm.article.photographers"
                    value-label="name"
                    has-custom-value-markup
                    pool="vm.persons"
                    on-save="vm.onPhotographersSave(value)">
                    <custom-value-markup>
                        <ul class="uk-list list-no-margin">
                            <li ng-repeat="photographer in $parent.vm.value" style="display: flex;">
                                <person-avatar user="photographer" size="30"></person-avatar>
                                <span person-widget="photographer" style="align-self: center; margin-left: 5px;">{{ photographer.name }}</span>
                            </li>
                        </ul>
                    </custom-value-markup>
                </editable-field>

                <editable-field
                    type="text"
                    label="'Eksterne'"
                    value="vm.article.external_photographer"
                    on-save="vm.onExternalPhotographerSave(value)"
                >
                </editable-field>
            </panel>
            <panel icon="'fas fa-tag'" header="'Detaljer'" type="'edit'">
                <editable-field
                    type="text"
                    label="'Navn'"
                    value="vm.article.name"
                    on-save="">
                </editable-field>
                <div>
                    <label class="uk-text-small form-label-text">Foto/Illustrasjon</label>

                    <div ng-hide="vm.metaEditMode">
                        <p ng-if="vm.article.use_illustration"><i class="fa fa-paint-brush"></i> Illustrasjon</p>
                        <p ng-if="!vm.article.use_illustration"><i class="fa fa-camera"></i> Foto</p>
                    </div>
                    <div class="uk-form-controls" ng-show="vm.metaEditMode">
                        <select class="uk-select uk-form-small" ng-model="vm.metaEditing.use_illustration"
                                ng-options="o.value as o.name for o in vm.photoTypes"></select>
                    </div>
                </div>

                <editable-field
                    type="select"
                    label="'Utgave'"
                    value="vm.article.publication"
                    value-label="name"
                    pool="vm.publications"
                    on-save="">
                </editable-field>
            </panel>
            <panel icon="'fas fa-list'" header="'Notater'" type="'edit'">
                <extra-header-content>
                    <button 
                        class="uk-button uk-button-primary button-xs"
                        ng-click="vm.saveNote()"
                    >
                        <i class="fa fa-save"></i> Lagre
                    </button>
                </extra-header-content>
                <div>
                    <textarea
                            id="noteArea"
                            class="uk-textarea"
                            ng-model="vm.article.note">
                    </textarea>
                </div>
            </panel>
        </div>
    </div>
</div>