<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <!--
  ~ Copyright 2014 Studentmediene i Trondheim AS
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~    http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->


    <!-- The initial changeset, containing the full database layout at release -->
    <changeSet id="1412787818529-1" author="Mats (generated)">
        <createTable tableName="article">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="comment" type="LONGTEXT"/>
            <column name="content" type="LONGTEXT"/>
            <column name="lastUpdated" type="datetime"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="note" type="LONGTEXT"/>
            <column name="photoStatus" type="VARCHAR(255)"/>
            <column name="publication_id" type="BIGINT(19)"/>
            <column name="section_id" type="BIGINT(19)"/>
            <column name="status_id" type="BIGINT(19)"/>
            <column name="type_id" type="BIGINT(19)"/>
        </createTable>

        <createTable tableName="article_journalist">
            <column name="Article_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="journalists_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="article_photographer">
            <column name="Article_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="photographers_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="articlerevision">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="content" type="LONGTEXT"/>
            <column name="savedDate" type="datetime"/>
            <column name="article_id" type="BIGINT(19)"/>
            <column name="author_id" type="BIGINT(19)"/>
            <column name="status_id" type="BIGINT(19)"/>
        </createTable>

        <createTable tableName="articlestatus">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="color" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="articletype">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="disposition">
            <column name="id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="publication_id" type="BIGINT(19)"/>
        </createTable>

        <createTable tableName="disposition_page">
            <column name="Disposition_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="pages_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="note">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="content" type="LONGTEXT"/>
            <column name="owner_id" type="BIGINT(19)"/>
        </createTable>

        <createTable tableName="page">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="advertisement" type="BOOLEAN" defaultValueBoolean="false"/>
            <column name="note" type="VARCHAR(255)"/>
            <column name="pageNr" type="INT(10)">
                <constraints nullable="false"/>
            </column>
            <column name="section_id" type="BIGINT(19)"/>
        </createTable>

        <createTable tableName="page_article">
            <column name="Page_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="articles_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="articles_ORDER" type="INT(10)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="person">
            <column name="id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="active" type="BOOLEAN" defaultValueBoolean="false"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="firstName" type="VARCHAR(255)"/>
            <column name="fullName" type="VARCHAR(255)"/>
            <column name="phoneNumber" type="VARCHAR(255)"/>
            <column name="username" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="publication">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
            <column name="releaseDate" type="date"/>
        </createTable>

        <createTable tableName="publication_page">
            <column name="Publication_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="pages_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="pages_ORDER" type="INT(10)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="section">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="source">
            <column autoIncrement="true" name="id" type="BIGINT(19)">
                <constraints primaryKey="true"/>
            </column>
            <column name="address" type="LONGTEXT"/>
            <column name="description" type="VARCHAR(255)"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="note" type="LONGTEXT"/>
            <column name="telephone" type="VARCHAR(255)"/>
            <column name="webPage" type="VARCHAR(255)"/>
        </createTable>

        <createTable tableName="source_sourcetag">
            <column name="Source_id" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="tags_tag" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <createTable tableName="sourcetag">
            <column name="tag" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addPrimaryKey columnNames="Article_id, journalists_id"  tableName="article_journalist"/>

        <addPrimaryKey columnNames="Article_id, photographers_id"  tableName="article_photographer"/>

        <addPrimaryKey columnNames="id" tableName="disposition"/>

        <addPrimaryKey columnNames="Disposition_id, pages_id" tableName="disposition_page"/>

        <addPrimaryKey columnNames="Page_id, articles_ORDER" tableName="page_article"/>

        <addPrimaryKey columnNames="id" tableName="person"/>

        <addPrimaryKey columnNames="Publication_id, pages_ORDER" tableName="publication_page"/>

        <addPrimaryKey columnNames="Source_id, tags_tag" tableName="source_sourcetag"/>

        <addPrimaryKey columnNames="tag" tableName="sourcetag"/>

        <addUniqueConstraint columnNames="pages_id" constraintName="pages_id_unique" deferrable="false" disabled="false" initiallyDeferred="false" tableName="disposition_page"/>

        <addForeignKeyConstraint baseColumnNames="owner_id" baseTableName="note" constraintName="FK_note_person" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="person"/>

        <addForeignKeyConstraint baseColumnNames="section_id" baseTableName="page" constraintName="FK_page_section" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="section"/>

        <addForeignKeyConstraint baseColumnNames="status_id" baseTableName="article" constraintName="FK_article_articlestatus" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="articlestatus"/>

        <addForeignKeyConstraint baseColumnNames="publication_id" baseTableName="article" constraintName="FK_article_publication" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="publication"/>

        <addForeignKeyConstraint baseColumnNames="type_id" baseTableName="article" constraintName="FK_article_articletype" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="articletype"/>

        <addForeignKeyConstraint baseColumnNames="section_id" baseTableName="article" constraintName="FK_article_section" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="section"/>

        <addForeignKeyConstraint baseColumnNames="photographers_id" baseTableName="article_photographer" constraintName="FK_article_photographer_person" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="person"/>

        <addForeignKeyConstraint baseColumnNames="Article_id" baseTableName="article_photographer" constraintName="FK_article_photographer_article" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="article"/>

        <addForeignKeyConstraint baseColumnNames="Page_id" baseTableName="page_article" constraintName="FK_page_article_page" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="page"/>

        <addForeignKeyConstraint baseColumnNames="articles_id" baseTableName="page_article" constraintName="FK_page_article_article" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="article"/>

        <addForeignKeyConstraint baseColumnNames="pages_id" baseTableName="publication_page" constraintName="FK_publication_page_page" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="page"/>

        <addForeignKeyConstraint baseColumnNames="Publication_id" baseTableName="publication_page" constraintName="FK_publication_page_publication" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="publication"/>

        <addForeignKeyConstraint baseColumnNames="Disposition_id" baseTableName="disposition_page" constraintName="FK_disposition_page_disposition" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="disposition"/>

        <addForeignKeyConstraint baseColumnNames="pages_id" baseTableName="disposition_page" constraintName="FK_disposition_page_page" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="page"/>

        <addForeignKeyConstraint baseColumnNames="publication_id" baseTableName="disposition" constraintName="FK_disposition_publication" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="publication"/>

        <addForeignKeyConstraint baseColumnNames="status_id" baseTableName="articlerevision" constraintName="FK_articlerevision_articlestatus" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="articlestatus"/>

        <addForeignKeyConstraint baseColumnNames="article_id" baseTableName="articlerevision" constraintName="FK_articlerevision_article" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="article"/>

        <addForeignKeyConstraint baseColumnNames="author_id" baseTableName="articlerevision" constraintName="FK_articlerevision_person" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="person"/>

        <addForeignKeyConstraint baseColumnNames="Article_id" baseTableName="article_journalist" constraintName="FK_article_journalist_article" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="article"/>

        <addForeignKeyConstraint baseColumnNames="journalists_id" baseTableName="article_journalist" constraintName="FK_article_journalist_person" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="person"/>

        <addForeignKeyConstraint baseColumnNames="tags_tag" baseTableName="source_sourcetag" constraintName="FK_source_sourcetag_sourcetag" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="tag" referencedTableName="sourcetag"/>

        <addForeignKeyConstraint baseColumnNames="Source_id" baseTableName="source_sourcetag" constraintName="FK_source_sourcetag_source" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="source"/>
    </changeSet>


    <!-- Adding some article metadata -->
    <changeSet id="2" author="Mats">
        <!-- sections -->
        <insert tableName="section"><column name="id">1</column><column name="name">Anmeldelse</column></insert>
        <insert tableName="section"><column name="id">2</column><column name="name">Debatt</column></insert>
        <insert tableName="section"><column name="id">3</column><column name="name">Nyhet</column></insert>
        <insert tableName="section"><column name="id">4</column><column name="name">Sport</column></insert>
        <insert tableName="section"><column name="id">5</column><column name="name">Forbruker</column></insert>
        <insert tableName="section"><column name="id">6</column><column name="name">Reportasje</column></insert>
        <insert tableName="section"><column name="id">7</column><column name="name">Spit</column></insert>
        <insert tableName="section"><column name="id">8</column><column name="name">Annet</column></insert>

        <!-- article types -->
        <insert tableName="articletype"><column name="id">1</column><column name="name">Anmeldelse</column></insert>
        <insert tableName="articletype"><column name="id">2</column><column name="name">Nyhetsartikkel</column></insert>
        <insert tableName="articletype"><column name="id">3</column><column name="name">Kulturartikkel</column></insert>
        <insert tableName="articletype"><column name="id">4</column><column name="name">Kulturtegn</column></insert>
        <insert tableName="articletype"><column name="id">5</column><column name="name">Reportasje</column></insert>

        <!-- statuses -->
        <insert tableName="articlestatus"><column name="id">1</column><column name="color">#fff</column><column name="name">Ukjent</column></insert>
        <insert tableName="articlestatus"><column name="id">2</column><column name="color">#eee</column><column name="name">Planlagt</column></insert>
        <insert tableName="articlestatus"><column name="id">3</column><column name="color">#aaf</column><column name="name">Skrives</column></insert>
        <insert tableName="articlestatus"><column name="id">4</column><column name="color">#faa</column><column name="name">Korrektur</column></insert>
        <insert tableName="articlestatus"><column name="id">5</column><column name="color">#afa</column><column name="name">Deskes</column></insert>
        <insert tableName="articlestatus"><column name="id">6</column><column name="color">#0f0</column><column name="name">Publisert</column></insert>
    </changeSet>



    <!-- Create some dummy data for DEV ONLY -->
    <changeSet id="3" author="Mats" context="dev">
        <!-- First some persons. These will be overridden by LDAP sync data shortly, but are needed here or the database gets angry -->
        <insert tableName="person"><column name="id">1006</column></insert>


        <!-- Some Publications -->
        <insert tableName="publication"><column name="id">1</column><column name="name">UD14-2013</column><column name="releaseDate" valueDate="2013-09-02"/></insert>
        <insert tableName="publication"><column name="id">2</column><column name="name">UD15-2013</column><column name="releaseDate" valueDate="2013-10-18"/></insert>
        <insert tableName="publication"><column name="id">3</column><column name="name">UD16-2013</column><column name="releaseDate" valueDate="2013-12-17"/></insert>
        <insert tableName="publication"><column name="id">4</column><column name="name">UD11-2014</column><column name="releaseDate" valueDate="2014-08-01"/></insert>
        <insert tableName="publication"><column name="id">5</column><column name="name">UD12-2014</column><column name="releaseDate" valueDate="2014-10-05"/></insert>
        <insert tableName="publication"><column name="id">6</column><column name="name">UD13-2014</column><column name="releaseDate" valueDate="2014-11-22"/></insert>
        <insert tableName="publication"><column name="id">7</column><column name="name">UD14-2014</column><column name="releaseDate" valueDate="2014-12-05"/></insert>
        <insert tableName="publication"><column name="id">8</column><column name="name">UD15-2014</column><column name="releaseDate" valueDate="2014-12-21"/></insert>

        <!-- Some dispositions -->
        <!-- TODO -->

        <!-- Some articles -->
        <insert tableName="article">
            <column name="id">1</column><column name="name">Siden Sist</column><column name="comment"></column><column name="lastUpdated"></column>
            <column name="publication_id">8</column><column name="section_id">3</column><column name="status_id">2</column><column name="type_id">2</column>
            <column name="content"></column>
            <column name="note"><![CDATA[<p>Hva har skjedd siden sist a?</p>]]></column>
        </insert>

        <!-- Some people connected to articles -->
        <insert tableName="article_journalist"><column name="Article_id">1</column><column name="journalists_id">1006</column></insert>

        <!-- And some revisions -->

        <!-- Some sources with tags, and some unused tags -->

        <!-- Some private notes -->


    </changeSet>





</databaseChangeLog>

